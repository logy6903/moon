<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ì´ë¯¸ì§€ ìš”ì•½í•˜ê¸° - ë…¼ìˆ ì˜ ëª¨ë“  ê²ƒ</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.3/dist/mermaid.min.js"></script>
    <style>
        /* í‚¤ì›Œë“œ ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš© */
        #keyword-input {
            height: 40px !important;
            font-size: 16px !important;
            pointer-events: auto !important;
            user-select: text !important;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            background-color: white !important;
            border: 1px solid #ccc !important;
            border-radius: 4px !important;
            padding: 8px 12px !important;
            width: 100% !important;
            box-sizing: border-box !important;
            z-index: 10 !important;
            position: relative !important;
            outline: none !important;
            cursor: text !important;
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            appearance: none !important;
            tabindex: 0 !important;
        }

        #keyword-input:focus {
            border-color: #4CAF50 !important;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2) !important;
        }

        #keyword-input:hover {
            border-color: #999 !important;
        }

        #new-problem-btn {
            padding: 10px 20px !important;
            font-size: 1rem !important;
            background-color: #198754 !important; /* Green color */
            color: white !important;
            border: none !important;
            border-radius: 4px !important;
            cursor: pointer !important;
        }

        /* --- ì´ë¯¸ì§€ ìš”ì•½í•˜ê¸° í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ --- */
        .image-summary-container {
            display: flex;
            align-items: flex-start; /* ì»¬ëŸ¼ë“¤ì„ ìœ„ì—ì„œë¶€í„° ì‹œì‘í•˜ë„ë¡ ì •ë ¬ */
            gap: 2rem;
        }

        .image-summary-col:first-child {
            flex: 1; /* ì™¼ìª½ ì»¬ëŸ¼ ë„ˆë¹„ */
            position: -webkit-sticky; /* Safari í˜¸í™˜ì„± */
            position: sticky;
            top: 2rem; /* í™”ë©´ ìƒë‹¨ì—ì„œ 2rem ë–¨ì–´ì§„ ìœ„ì¹˜ì— ê³ ì • */
        }
        
        .image-summary-col:last-child {
            flex: 1; /* ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ ë„ˆë¹„ */
        }

        .content-box {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            min-height: 400px;
            flex-grow: 1; /* ì»¬ëŸ¼ ë‚´ì—ì„œ ë‚¨ëŠ” ê³µê°„ ì°¨ì§€ */
        }
        #image-display-area {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #image-display-area img {
            max-width: 100%;
            max-height: 450px;
            object-fit: contain;
            border-radius: 4px;
        }

        /* Q&A ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        #qa-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .qa-card {
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
        }
        .question-text {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .user-answer-input {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            resize: vertical;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        .model-answer {
            background-color: #f0f8ff;
            border: 1px solid #d1e7fd;
            border-radius: 4px;
            padding: 15px;
            margin-top: 10px;
        }

        /* ë¶„ì„ ê²°ê³¼(ì˜¤ë¥¸ìª½) ì˜ì—­ ìŠ¤íƒ€ì¼ */
        #analysis-result-container {
            display: flex;
        }

        /* ì¸ê³¼ ì„¤ëª… í˜ì´ì§€ì—ì„œ ê°€ì ¸ì˜¨ ìŠ¤íƒ€ì¼ */
        .form-content-wrapper { flex-grow: 1; overflow-y: auto; padding: 1.5rem; }
        .form-content-wrapper > h3 { margin-top: 0; margin-bottom: 1rem; }
        .form-actions-footer { flex-shrink: 0; padding: 1rem 1.5rem; border-top: 1px solid #eee; background-color: #fff; }
        .form-actions-footer hr { margin: 0.8rem 0; }
        .right-panel > .card { display: flex; flex-direction: column; flex-grow: 1; overflow: hidden; padding: 0; }
        .ground-block { border: 1px solid #f0f0f0; background-color: #fafafa; border-radius: 6px; padding: 1rem; margin-bottom: 1rem; }
        .ground-block-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
        .ground-block-header label { margin-bottom: 0; font-size: 1.1em; font-weight: 500; }
        button.remove-ground-btn { padding: 2px 8px; font-size: 0.9em; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }

        /* ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸° ì˜ì—­ ìŠ¤íƒ€ì¼ ê°œì„  */
        .image-generation-form {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .image-generation-form .form-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0;
        }

        .image-generation-form .form-group input[type="text"] {
            flex: 0 0 300px;
            max-width: 300px;
        }

        .image-generation-form .radio-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .image-generation-form .radio-group label {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 0.9em;
            margin: 0;
        }

        .image-generation-form .form-group label {
            font-weight: bold;
            margin-right: 5px;
        }

        .image-generation-form .form-group-actions {
            margin-left: auto;
        }

        /* ì°¨íŠ¸ ì„ íƒ UI ìŠ¤íƒ€ì¼ */
        .chart-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 6px;
            margin-bottom: 10px;
        }

        .chart-type-btn {
            padding: 6px 8px;
            border: 2px solid #ddd;
            background-color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: 500;
            text-align: center;
            transition: all 0.3s ease;
            white-space: normal;
            word-wrap: break-word;
            min-height: 36px;
            max-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
            color: #333 !important;
            font-family: Arial, sans-serif !important;
        }

        .chart-type-btn:hover {
            border-color: #4CAF50;
            background-color: #f8f9fa;
            transform: translateY(-1px);
            color: #333 !important;
        }

        .chart-type-btn.selected {
            border-color: #4CAF50;
            background-color: #4CAF50;
            color: white !important;
            font-weight: bold;
        }

        .chart-type-btn[data-chart-type="auto"] {
            background-color: #007bff;
            color: white !important;
            border-color: #007bff;
            font-weight: bold;
        }

        .chart-type-btn[data-chart-type="auto"]:hover {
            background-color: #0056b3;
            border-color: #0056b3;
            color: white !important;
        }

        .chart-type-btn[data-chart-type="auto"].selected {
            background-color: #0056b3;
            border-color: #0056b3;
            color: white !important;
        }

        .selected-charts-display {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        #selected-count {
            font-weight: bold;
            color: #495057;
            font-size: 0.9em;
            margin: 0;
            white-space: nowrap;
        }

        #selected-chart-list {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            flex: 1;
        }

        .selected-chart-tag {
            background-color: #4CAF50;
            color: white;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            font-weight: 500;
        }

        .chart-selection-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
        }

        .chart-selection-actions button {
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.85em;
        }

        /* ì•ˆë‚´ ë¬¸êµ¬ ìŠ¤íƒ€ì¼ */
        .instruction-message {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 12px 15px;
            font-size: 0.95em;
            color: #495057;
            text-align: center;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .instruction-message.public-ad {
            background-color: #e8f5e8;
            border-color: #4CAF50;
            color: #2d5a2d;
        }

        .instruction-message.statistics {
            background-color: #e7f3ff;
            border-color: #007bff;
            color: #004085;
        }

        .instruction-message.data-set {
            background-color: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }
    </style>
</head>
<body>
    <script>
        mermaid.initialize({ startOnLoad: false });
    </script>
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="index.html">ë¶„ì„ì  ìš”ì•½í•˜ê¸°</a>
        </div>
        <div class="navbar-menu">
            <a href="argument-summary.html" class="mode-btn">ë…¼ì¦ ìš”ì•½í•˜ê¸°</a>
            <a href="argument-summary.html?tab=non-argument" class="mode-btn">ë¹„ë…¼ì¦ ìš”ì•½í•˜ê¸°</a>
            <a href="image-summary.html" class="mode-btn active">ì´ë¯¸ì§€ ìš”ì•½í•˜ê¸°</a>
            <a href="#" class="mode-btn" onclick="alert('ì—…ë°ì´íŠ¸ ì¤‘ì…ë‹ˆë‹¤.'); return false;">ë¹„êµí•˜ê¸°</a>
        </div>
        <div class="navbar-right">
            <a href="index.html" class="mode-btn">ë©”ì¸ í˜ì´ì§€</a>
        </div>
    </nav>
    <main>
        <div class="container left-panel">
            <h2>ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°</h2>
            <div id="image-generation-card" class="card">
                <div class="image-generation-form">
                    <div class="form-group">
                        <label>ìœ í˜•:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="image_type" value="public_ad" checked> ê³µìµ ê´‘ê³ </label>
                            <label><input type="radio" name="image_type" value="statistics"> í†µê³„ ì°¨íŠ¸</label>
                            <label><input type="radio" name="image_type" value="data_set"> í†µê³„í‘œ</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div id="instruction-text" class="instruction-message">
                            <!-- ì„ íƒëœ ìœ í˜•ì— ë”°ë¼ ë™ì ìœ¼ë¡œ ë³€ê²½ë˜ëŠ” ì•ˆë‚´ ë¬¸êµ¬ -->
                        </div>
                        <!-- í‚¤ì›Œë“œ í•„ë“œë¥¼ ìˆ¨ê¹€ì²˜ë¦¬ (JavaScriptì—ì„œ ëœë¤ í‚¤ì›Œë“œ ì„¤ì •ìš©) -->
                        <input type="hidden" id="keyword-input" value="">
                    </div>
                    <div class="form-group-actions">
                        <button id="generate-image-btn" class="primary">ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                    </div>
                </div>
            </div>
            <!-- ì°¨íŠ¸ ì¢…ë¥˜ ì„ íƒ UI -->
            <div id="chart-type-selection-card" class="card" style="display: none;">
                <h3 style="margin-bottom: 10px; font-size: 1.1em;">ì°¨íŠ¸ ì¢…ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš”. (2ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥)</h3>
                <div id="chart-type-buttons" class="chart-type-grid">
                    <button class="chart-type-btn" data-chart-type="radar">ë ˆì´ë” ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="bubble">ë²„ë¸” ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="bar">ë§‰ëŒ€ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="line">ì„  ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="pie">íŒŒì´ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="area">ì˜ì—­ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="trend">ì¶”ì„¸ ë¶„ì„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="multiLine">ë‹¤ì¤‘ì„  ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="correlation">ìƒê´€ê´€ê³„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="multiVar">ë‹¤ë³€ìˆ˜ ë¶„ì„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="comparison">ë¹„êµ ë¶„ì„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="regional">ì§€ì—­ë³„ ë¹„êµ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="sectoral">ë¶€ë¬¸ë³„ ë¶„ì„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="stacked">ëˆ„ì  ë§‰ëŒ€ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="scatter">ì‚°ì ë„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="polarArea">ê·¹ì¶• ì˜ì—­ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="doughnut">ë„ë„› ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="candlestick">ìº”ë“¤ìŠ¤í‹± ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="waterfall">í­í¬ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="funnel">ê¹”ë•Œê¸° ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="mixed">í˜¼í•©í˜• ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="economic">ê²½ì œ ë¶„ì„ ì°¨íŠ¸</button>
                    <button class="chart-type-btn" data-chart-type="auto">ğŸ¤– AI ìë™ ì„ íƒ</button>
                </div>
                <div id="selected-charts-info" class="selected-charts-display">
                    <span id="selected-count">ì„ íƒëœ ì°¨íŠ¸: 0ê°œ</span>
                    <div id="selected-chart-list"></div>
                    <div class="chart-selection-actions">
                        <button id="clear-selection-btn" class="secondary">ì„ íƒ ì´ˆê¸°í™”</button>
                        <button id="generate-selected-charts-btn" class="primary" disabled>ì„ íƒí•œ ì°¨íŠ¸ë¡œ ìƒì„±</button>
                    </div>
                </div>
            </div>

            <div id="image-display-container" class="card" style="display: none;">
                <div id="image-display" class="passage-box"></div>
            </div>
        </div>

        <div class="container right-panel">
            <!-- ê³µìµ ê´‘ê³  ë¶„ì„ íŒ¨ë„ -->
            <div id="image-analysis-panel" style="display: block;">
                <h2>ì´ë¯¸ì§€ ë¶„ì„í•˜ê¸°</h2>
                <div id="summary-form" class="card">
                    <div class="form-content-wrapper">
                        <h3>ë…¼ì¦ êµ¬ì¡° ë¶„ì„</h3>
                        <div class="form-group-vertical">
                            <label for="user-issue">ìŸì </label>
                            <textarea id="user-issue" class="summary-textarea" placeholder="ì´ë¯¸ì§€ê°€ ë‹¤ë£¨ëŠ” í•µì‹¬ ìŸì ì„ ì‘ì„±í•˜ì„¸ìš”."></textarea>
                        </div>
                        <div class="form-group-vertical">
                            <label for="user-claim">ì£¼ì¥</label>
                            <textarea id="user-claim" class="summary-textarea" placeholder="ì´ë¯¸ì§€ì˜ í•µì‹¬ ì£¼ì¥ì„ '~í•´ì•¼ í•œë‹¤' ë˜ëŠ” '~í•´ì„œëŠ” ì•ˆëœë‹¤' í˜•íƒœë¡œ ì‘ì„±í•˜ì„¸ìš”."></textarea>
                        </div>
                        <div id="grounds-container">
                            <!-- ê·¼ê±° ë¸”ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. -->
                        </div>
                    </div>
                    <div class="form-actions-footer">
                        <div class="form-group-actions">
                            <button type="button" id="add-ground-btn" class="secondary">+ ê·¼ê±° ì¶”ê°€</button>
                        </div>
                        <hr>
                        <div class="form-group-actions">
                            <button id="show-model-answer-btn" class="primary" disabled>ğŸ“‹ ëª¨ë²”ë‹µì•ˆ í™•ì¸</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- í†µê³„ ìë£Œ ë¶„ì„ íŒ¨ë„ -->
            <div id="data-analysis-panel" style="display: none;">
                <h2>ë°ì´í„° ë¶„ì„í•˜ê¸°</h2>
                <div id="data-analysis-form" class="card">
                    <div class="form-content-wrapper">
                        <h3 id="data-analysis-title">ğŸ“Š í†µê³„ ìë£Œ ë¶„ì„</h3>
                        <div class="data-analysis-scroll" id="data-questions-container">
                            <!-- ì§ˆë¬¸ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                    <div class="form-actions-footer">
                        <div class="form-group-actions">
                            <button id="show-data-model-answer-btn" class="primary" disabled>ğŸ“‹ ëª¨ë²”ë‹µì•ˆ í™•ì¸</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- AI ë¶„ì„ ê²°ê³¼ í‘œì‹œìš© íŒì—… -->
    <div id="analysis-popup-backdrop" class="popup-backdrop"></div>
    <!-- ì´ë¯¸ì§€/ì°¨íŠ¸ íŒì—… ì°½ -->
    <div id="image-popup" class="image-popup-window">
        <div class="popup-header" id="image-popup-header">
            <h3 id="image-popup-title">ì‹œê°í™” ìë£Œ</h3>
            <div class="popup-controls">
                <button class="popup-minimize" id="image-popup-minimize">âˆ’</button>
                <button class="popup-close" id="image-popup-close">Ã—</button>
            </div>
        </div>
        <div class="popup-content" id="image-popup-content">
            <!-- ì°¨íŠ¸ë‚˜ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
        <div class="popup-resize-handle" id="image-resize-handle"></div>
    </div>

    <div id="analysis-popup" class="popup-window">
        <div class="popup-header">
            <h3>AI ë…¼ì¦ ë¶„ì„ ê²°ê³¼</h3>
            <button id="popup-close-btn" class="popup-close">&times;</button>
        </div>
        <div id="popup-content" class="popup-body"></div>
    </div>

    <script src="image-summary-script.js?v=13.0"></script>
</body>
</html>